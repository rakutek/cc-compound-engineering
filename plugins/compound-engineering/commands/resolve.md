---
name: resolve
description: 並列処理を使用してTODOを解決（コード内コメント・CLI TODO両対応）
argument-hint: "[オプション: 特定のTODOパターンまたはファイル]"
---

並列処理を使用してすべてのTODOを解決します。コード内のTODOコメントとCLI TODOシステム（/todos/*.md）の両方に対応します。

## 自動検出機能

このコマンドは自動的にTODOの種類を検出します：

1. **CLI TODOモード**: `/todos/*.md`ディレクトリが存在し、未解決TODOがある場合
2. **コード内TODOモード**: コードベース内にTODOコメントが存在する場合
3. **混在モード**: 両方が存在する場合、両方を処理

引数を指定することで特定のTODOのみを対象にできます：
- 特定のパターン（例：`"TODO: implement"`）
- 特定のファイル（例：`src/auth.py`）
- 特定のCLI TODO ID（例：`#123`）

## ワークフロー

### 1. 分析

TODOソースを自動検出：

**CLI TODOの場合**:
- `/todos/*.md`ディレクトリからすべての未解決TODOを取得

**コード内TODOの場合**:
- コードベース全体からTODOコメントを検索
- 該当する場合は引数で指定されたパターンやファイルでフィルタリング

### 2. 計画

タイプ別にグループ化されたすべての未解決アイテムのTodoWriteリストを作成します。発生する可能性のある依存関係を確認し、他で必要とされるものを優先します。例えば、名前を変更する必要がある場合、他のものを先に待つ必要があります。これをどのように行えるかを示すmermaidフローダイアグラムを出力します。すべてを並列で行えますか？他を並列で進めるために最初に1つを行う必要がありますか？エージェントが順番に進む方法を知るために、mermaidダイアグラムにフロー形式でToDoを配置します。

### 3. 実装（並列）

各未解決アイテムに対してpr-comment-resolverエージェントを並列で起動します。

3つのコメントがある場合、3つのpr-comment-resolverエージェントを並列で起動します。このように：

1. Task pr-comment-resolver(comment1)
2. Task pr-comment-resolver(comment2)
3. Task pr-comment-resolver(comment3)

各Todoアイテムに対して常にすべてのサブエージェント/Taskを並列で実行します。

### 4. コミット & 解決

**CLI TODOの場合**:
- 変更をコミット
- ファイルからTODOを削除し、解決済みとしてマーク
- リモートにプッシュ

**コード内TODOの場合**:
- 変更をコミット
- リモートにプッシュ

## 使用例

```bash
# すべてのTODOを自動検出して解決
/resolve

# 特定のパターンに一致するTODOのみ解決
/resolve "TODO: implement auth"

# 特定のファイル内のTODOのみ解決
/resolve src/components/Header.tsx

# 特定のCLI TODO IDを解決
/resolve #123
```

## 注意事項

- 並列処理により複数のTODOを同時に解決するため、依存関係の分析が重要です
- 変更は自動的にコミット・プッシュされます
- CLI TODOは解決後に自動的にファイルから削除されます
